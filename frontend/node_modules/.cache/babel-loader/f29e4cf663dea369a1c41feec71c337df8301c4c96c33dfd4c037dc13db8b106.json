{"ast":null,"code":"import _objectSpread from\"C:/Users/Lenovo/Downloads/projects by pemtuk/qrmenu (2)/qrmenu/qrmenu/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import HomePage from\"./components/HomePage\";import CustomerMenu from\"./components/CustomerMenu\";import LoginPage from\"./components/LoginPage\";import Dashboard from\"./components/Dashboard\";import{BrowserRouter as Router,Routes,Route}from\"react-router-dom\";import Aboutus from\"./components/Aboutus\";import\"./styles/LoginSignup.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[page,setPage]=useState(\"home\");const[menu,setMenu]=useState([]);const[orders,setOrders]=useState([]);// Fetch menu from backend\nconst fetchMenu=async()=>{try{const token=localStorage.getItem(\"token\");const user=JSON.parse(localStorage.getItem(\"user\"));const res=await axios.get(\"/api/menu\",{headers:{Authorization:token?\"Bearer \".concat(token):undefined},params:{userId:user===null||user===void 0?void 0:user.id// fallback for GET if backend needs it\n}});setMenu(res.data);}catch(_unused){setMenu([]);}};// Fetch menu on mount and when login/signup occurs\nuseEffect(()=>{fetchMenu();},[]);// Fetch menu again after login/signup\nconst handleLoginSuccess=()=>{setPage(\"home\");fetchMenu();// Refresh menu after login/signup\n};// Add menu item via backend, then refresh menu\nconst handleAddMenuItem=async item=>{try{const token=localStorage.getItem(\"token\");await axios.post(\"/api/menu\",item,{headers:{Authorization:token?\"Bearer \".concat(token):undefined}});await fetchMenu();// Refresh menu after adding\n}catch(err){// handle error (e.g., show message)\n}};// Remove menu item via backend, then refresh menu\nconst handleRemoveMenuItem=async id=>{try{const token=localStorage.getItem(\"token\");await axios.delete(\"/api/menu/\".concat(id),{headers:{Authorization:token?\"Bearer \".concat(token):undefined}});await fetchMenu();// Refresh menu after removing\n}catch(err){// handle error (e.g., show message)\n}};const handlePlaceOrder=order=>{setOrders(prev=>[...prev,_objectSpread(_objectSpread({},order),{},{id:Date.now(),status:\"Pending\",table:order.table||\"N/A\"// You can enhance this to collect table info\n})]);};// Check authentication by token presence\nconst isLoggedIn=!!localStorage.getItem(\"token\");// If logged in, always show Dashboard\nif(isLoggedIn){return/*#__PURE__*/_jsx(Dashboard,{menu:menu,setMenu:setMenu,orders:orders,setOrders:setOrders,onAddMenuItem:handleAddMenuItem,onRemoveMenuItem:handleRemoveMenuItem});}// Helper to get userId from query string (for customer menu)\nfunction getUserIdFromQuery(){const params=new URLSearchParams(window.location.search);return params.get(\"userId\");}// Show CustomerMenu if page is \"menu\" or path is \"/menu\"\nif(page===\"menu\"||window.location.pathname===\"/menu\"){const userId=getUserIdFromQuery();return/*#__PURE__*/_jsx(CustomerMenu,{menu:menu,onBack:()=>setPage(\"home\"),onPlaceOrder:handlePlaceOrder,userId:userId});}// Show HomePage, LoginPage, or SignupPage\nreturn/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[page===\"home\"&&/*#__PURE__*/_jsx(HomePage,{onViewMenu:()=>setPage(\"menu\"),onLogin:()=>setPage(\"LoginPage\"),onSignup:()=>setPage(\"SignupPage\")}),page===\"LoginPage\"&&/*#__PURE__*/_jsx(LoginPage,{onLogin:handleLoginSuccess}),page===\"SignupPage\"&&/*#__PURE__*/_jsx(LoginPage,{signupMode:true,onLogin:handleLoginSuccess}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/aboutus\",element:/*#__PURE__*/_jsx(Aboutus,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(LoginPage,{})})]})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","HomePage","CustomerMenu","LoginPage","Dashboard","BrowserRouter","Router","Routes","Route","Aboutus","jsx","_jsx","jsxs","_jsxs","App","page","setPage","menu","setMenu","orders","setOrders","fetchMenu","token","localStorage","getItem","user","JSON","parse","res","get","headers","Authorization","concat","undefined","params","userId","id","data","_unused","handleLoginSuccess","handleAddMenuItem","item","post","err","handleRemoveMenuItem","delete","handlePlaceOrder","order","prev","_objectSpread","Date","now","status","table","isLoggedIn","onAddMenuItem","onRemoveMenuItem","getUserIdFromQuery","URLSearchParams","window","location","search","pathname","onBack","onPlaceOrder","children","className","onViewMenu","onLogin","onSignup","signupMode","path","element"],"sources":["C:/Users/Lenovo/Downloads/projects by pemtuk/qrmenu (2)/qrmenu/qrmenu/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport HomePage from \"./components/HomePage\";\r\nimport CustomerMenu from \"./components/CustomerMenu\";\r\nimport LoginPage from \"./components/LoginPage\";\r\nimport Dashboard from \"./components/Dashboard\";\r\nimport { BrowserRouter as Router, Routes, Route } from \"react-router-dom\";\r\nimport Aboutus from \"./components/Aboutus\";\r\nimport \"./styles/LoginSignup.css\";\r\n\r\nfunction App() {\r\n  const [page, setPage] = useState(\"home\");\r\n  const [menu, setMenu] = useState([]);\r\n  const [orders, setOrders] = useState([]);\r\n\r\n  // Fetch menu from backend\r\n  const fetchMenu = async () => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      const user = JSON.parse(localStorage.getItem(\"user\"));\r\n      const res = await axios.get(\"/api/menu\", {\r\n        headers: {\r\n          Authorization: token ? `Bearer ${token}` : undefined,\r\n        },\r\n        params: {\r\n          userId: user?.id, // fallback for GET if backend needs it\r\n        },\r\n      });\r\n      setMenu(res.data);\r\n    } catch {\r\n      setMenu([]);\r\n    }\r\n  };\r\n\r\n  // Fetch menu on mount and when login/signup occurs\r\n  useEffect(() => {\r\n    fetchMenu();\r\n  }, []);\r\n\r\n  // Fetch menu again after login/signup\r\n  const handleLoginSuccess = () => {\r\n    setPage(\"home\");\r\n    fetchMenu(); // Refresh menu after login/signup\r\n  };\r\n\r\n  // Add menu item via backend, then refresh menu\r\n  const handleAddMenuItem = async (item) => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      await axios.post(\"/api/menu\", item, {\r\n        headers: {\r\n          Authorization: token ? `Bearer ${token}` : undefined,\r\n        },\r\n      });\r\n      await fetchMenu(); // Refresh menu after adding\r\n    } catch (err) {\r\n      // handle error (e.g., show message)\r\n    }\r\n  };\r\n\r\n  // Remove menu item via backend, then refresh menu\r\n  const handleRemoveMenuItem = async (id) => {\r\n    try {\r\n      const token = localStorage.getItem(\"token\");\r\n      await axios.delete(`/api/menu/${id}`, {\r\n        headers: {\r\n          Authorization: token ? `Bearer ${token}` : undefined,\r\n        },\r\n      });\r\n      await fetchMenu(); // Refresh menu after removing\r\n    } catch (err) {\r\n      // handle error (e.g., show message)\r\n    }\r\n  };\r\n\r\n  const handlePlaceOrder = (order) => {\r\n    setOrders((prev) => [\r\n      ...prev,\r\n      {\r\n        ...order,\r\n        id: Date.now(),\r\n        status: \"Pending\",\r\n        table: order.table || \"N/A\", // You can enhance this to collect table info\r\n      },\r\n    ]);\r\n  };\r\n\r\n  // Check authentication by token presence\r\n  const isLoggedIn = !!localStorage.getItem(\"token\");\r\n\r\n  // If logged in, always show Dashboard\r\n  if (isLoggedIn) {\r\n    return (\r\n      <Dashboard\r\n        menu={menu}\r\n        setMenu={setMenu}\r\n        orders={orders}\r\n        setOrders={setOrders}\r\n        onAddMenuItem={handleAddMenuItem}\r\n        onRemoveMenuItem={handleRemoveMenuItem}\r\n      />\r\n    );\r\n  }\r\n\r\n  // Helper to get userId from query string (for customer menu)\r\n  function getUserIdFromQuery() {\r\n    const params = new URLSearchParams(window.location.search);\r\n    return params.get(\"userId\");\r\n  }\r\n\r\n  // Show CustomerMenu if page is \"menu\" or path is \"/menu\"\r\n  if (page === \"menu\" || window.location.pathname === \"/menu\") {\r\n    const userId = getUserIdFromQuery();\r\n    return (\r\n      <CustomerMenu\r\n        menu={menu}\r\n        onBack={() => setPage(\"home\")}\r\n        onPlaceOrder={handlePlaceOrder}\r\n        userId={userId}\r\n      />\r\n    );\r\n  }\r\n\r\n  // Show HomePage, LoginPage, or SignupPage\r\n  return (\r\n    <Router>\r\n      <div className=\"App\">\r\n        {page === \"home\" && (\r\n          <HomePage\r\n            onViewMenu={() => setPage(\"menu\")}\r\n            onLogin={() => setPage(\"LoginPage\")}\r\n            onSignup={() => setPage(\"SignupPage\")}\r\n          />\r\n        )}\r\n        {page === \"LoginPage\" && <LoginPage onLogin={handleLoginSuccess} />}\r\n        {page === \"SignupPage\" && (\r\n          <LoginPage signupMode={true} onLogin={handleLoginSuccess} />\r\n        )}\r\n        <Routes>\r\n          <Route path=\"/aboutus\" element={<Aboutus />} />\r\n          <Route path=\"/login\" element={<LoginPage />} />\r\n          {/* ...other routes... */}\r\n        </Routes>\r\n      </div>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}